<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Create New Project - STRYKE</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f7f7f7;
            margin: 20px;
        }
        .container {
            max-width: 600px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .nav-link {
            margin-bottom: 15px;
            display: inline-block;
        }
        h1 {
            color: #0056b3;
        }
        label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        textarea {
            height: 100px;
        }
        button {
            margin-top: 15px;
            padding: 10px 15px;
            background: #007BFF;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background: #0056b3;
        }
        .project-management {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #007BFF;
        }
        .project-management h3 {
            margin-top: 0;
            font-size: 18px;
            color: #0056b3;
        }
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
            align-items: center;
        }
        .btn-small {
            display: inline-block;
            padding: 8px 12px;
            background: #ffc107;
            color: #000;
            text-decoration: none;
            border-radius: 4px;
            font-size: 14px;
            border: none;
            cursor: pointer;
            margin: 0;
        }
        .btn-small:hover {
            background: #e0a800;
        }
        .btn-load {
            background: #17a2b8;
            color: white;
            border: none;
        }
        .btn-load:hover {
            background: #138496;
        }
    </style>
    <script src="{{ url_for('static', filename='autosave.js') }}"></script>
    <script src="{{ url_for('static', filename='validation.js') }}"></script>
    <script src="{{ url_for('static', filename='enable-on-change.js') }}"></script>
</head>
<body>
    <div class="container">
        <a href="{{ url_for('index') }}" class="nav-link">Home</a>
        <h1>Create New Project</h1>
        <p class="instructions">
            Welcome to the project creation page! Here, you‚Äôll give your project a 
            name and a brief description, and pick the number of generating 
            stations in your model.  The model setup is meant to be flexible,
            it is possible to simulate a single turbine or multiple turbines at 
            multiple facilities. Once you are satistifed with your choice of 
            simulation mode, click ‚ÄúSave Project,‚Äù and you‚Äôll move on to defining 
            your flow scenarios and other details. If you need help with any field, 
            look for the little info icons or contact support via GitHub.
            
            If at any point in time you want to start over, simpy navigate to the
            home page and log out.  Any session data you create will be destroyed.
        </p>

        <form method="post">
            <label for="project_name">Project Name:</label>
            <input type="text" name="project_name" id="project_name" maxlength="50" value="{{ project_name or '' }}" required>

            <label for="project_notes">Project Notes:</label>
            <textarea name="project_notes" id="project_notes" maxlength="255">{{ project_notes or '' }}</textarea>

            <label for="units">Choose Units:</label>
            <select name="units" id="units">
                <option value="metric" {% if units == 'metric' or not units %}selected{% endif %}>Metric</option>

            </select>

            <label for="model_setup">Model Setup:</label>
            <select name="model_setup" id="model_setup">
                <option value="single_unit_survival_only" {% if model_setup == 'single_unit_survival_only' %}selected{% endif %}>Specified single unit, survival only, no movement</option>
                <option value="single_unit_simulated_entrainment" {% if model_setup == 'single_unit_simulated_entrainment' %}selected{% endif %}>Specified single unit with simulated entrainment events and survival, no movement</option>
                <option value="single_powerhouse_simulated_entrainment_routing" {% if model_setup == 'single_powerhouse_simulated_entrainment_routing' %}selected{% endif %}>Single Powerhouse with movement, simulated entrainment, survival </option>
                <option value="multiple_powerhouses_simulated_entrainment_routing" {% if model_setup == 'multiple_powerhouses_simulated_entrainment_routing' %}selected{% endif %}>Multiple Dependent Powerhouses with movement, simulated entrainment, survival </option>
            </select>

            <button type="submit" id="createProjectBtn" data-enable-on-change="true" {% if project_loaded %}disabled style="background: #ccc; cursor: not-allowed;"{% endif %}>Create Project</button>
            
            <!-- enable-on-change handled by shared static JS -->
            <button type="button" onclick="window.location.href='{{ url_for('flow_scenarios') }}'">Next Page ‚Üí</button>
        </form>
        
        <!-- Project Save/Load Section -->
        <div class="project-management">
            <h3>üíæ Save or Load Project</h3>
            <p style="font-size: 14px; margin: 8px 0;">Save your entire project to continue later, or load a previously saved project:</p>
            
            <div class="btn-group">
                <!-- Save Project -->
                <form method="post" action="{{ url_for('save_project') }}" style="display: inline-block; margin: 0;" class="no-validate">
                    <button type="submit" class="btn-small">üíæ Save Project</button>
                </form>
                
                <!-- Load Project -->
                <form method="post" action="{{ url_for('load_project') }}" enctype="multipart/form-data" style="display: inline-block; margin: 0;" class="no-validate">
                    <label for="project_file_create" class="btn-small btn-load" style="cursor: pointer; margin: 0;">
                        üìÇ Load Project
                        <input type="file" id="project_file_create" name="project_file" accept=".stryke" 
                               style="display: none;" onchange="this.form.submit()">
                    </label>
                </form>
            </div>
            
            <p style="font-size: 12px; color: #666; margin-top: 8px;">
                <em>üí° Projects save to your Downloads folder as .stryke files</em>
            </p>
        </div>
    </div>
    
    <script src="{{ url_for('static', filename='autosave.js') }}"></script>
    <script src="{{ url_for('static', filename='validation.js') }}"></script>
    {% if project_loaded %}
    <script>
        // Clear auto-save when project is loaded to prevent restore prompt
        localStorage.removeItem('stryke_autosave');
        localStorage.removeItem('stryke_autosave_timestamp');
    </script>
    {% endif %}
</body>
</html>
